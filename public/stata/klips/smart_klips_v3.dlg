/*=======================================================================
KLIPS 패널데이터 만들어주는 db
smart_klips and smart_klips_add
2015-09-03
2017-06-30 : 1차 - 19차 업데이트 
2018-06-29 : 20차 업데이트 
2019-10-15: 21차 업데이터 
2019-11-09: Version 3 (21차 까지 사용)
2020-11-06: Web버전을 위한 수정 
2020-11-09: 22차 업데이트 
2020-12-01: 불필요한 옵션 no show 
2021-02-01: KLI 요청사항 업데이트
2021-02-02: 노동패널팀 수정 
1) Optional : add variables 부분 라벨 변경 
2) h_weight18, p_weight18_l, p_weight_c 변수추가에 따란 목록 추가  
2021-07-12: 23차 추가 
=======================================================================*/
VERSION 14.0
POSITION . . 630 600   //600

DIALOG main, label("Smart KLIPS") tabtitle("KLIPS") 
BEGIN 
     
	 TEXT tx_wave00    60 20 120 ., label("선택 : ")
	 *COMBOBOX cb_stat1  120 @ 100 ., option("wide") dropdownlist contents(stat_list) values(stat_value) 	 	 
	 RADIO rd_wave00   140 @ 140 .,  first label("통합 패널데이터 생성") option(smart_klips_v3) default(1) onclickon(script button1) 
	 RADIO rd_wave01   330  @ 140 ., last label("KLIPS원자료 변수 검색") option(smart_klips_search_v3) default(0) onclickon(script button2) 	 
	 
	 		 
	 GROUPBOX gb_opts0 10 +20 600 360 , label("통합 패널데이터 생성") 
	 	 
	 TEXT tx_wave1  20 +20 100 ., label("가구용 가공 변수")
	 COMBOBOX vl_dta1 20 +20 550 240, dropdown contents(region_list1) append default("")	 
	 TEXT tx_wave2  20 +30 100 ., label("개인용 가공 변수")
	 COMBOBOX vl_dta2 20 +20 550 240, dropdown contents(region_list2) append default("")	 
	
/***** 노동패널팀 수정: Optional : add variables (가구레벨)부분 라벨 수정 *****/

	 TEXT tx_wave3  20 +30 300 ., label("(선택사항) KLIPS원자료 변수 추가(가구용) (예: h0141)")
	 EDIT ed_wave3 20 +20 550 .,  error("추가하고자 하는 변수이름")
	 
/***** 노동패널팀 수정: Optional : add variables (가구원 레벨)부분 라벨 수정 *****/
	 TEXT tx_wave4  20 +30 300 ., label("(선택사항) KLIPS원자료 변수 추가(개인용) (예: p0111)")
	 EDIT ed_wave4 20 +20 550 .,  error("추가하고자 하는 변수이름")	  
	 
	 TEXT tx_wave5 20 +30 450 ., label("(선택사항) KLIPS원자료 변수 추가(부가조사) 최대 3개 동시 선택 가능 (예: a0111)")
	 *TEXT tx_wave5_0 20 +20 580 ., label("주의사항: 부가조사 변수를 가져오기 위해서는 위쪽 메뉴에서 가구원레벨 변수를 최소 1개 선택해야 합니다")
	 COMBOBOX ed_wave5_1 20 +20 150 ., option("") dropdownlist contents(stat_list1) values(stat_value1) onselchangelist(sel_list1)
	 EDIT ed_wave5_2     180 @ 390 .,  error("추가하고자 하는 변수이름")	 
	 COMBOBOX ed_wave6_1 20 +30 150 ., option("") dropdownlist contents(stat_list1) values(stat_value1) onselchangelist(sel_list2)	 
	 EDIT ed_wave6_2     180 @ 390 .,  error("추가하고자 하는 변수이름")
	 COMBOBOX ed_wave7_1 20 +30 150 ., option("") dropdownlist contents(stat_list1) values(stat_value1)   
	 EDIT ed_wave7_2     180 @ 390 .,  error("추가하고자 하는 변수이름")
	 	 
	 
	 TEXT tx_wd1 20 +30 70 ., label("저장 파일명")
	 EDIT ed_wd1 100 @ 190 .,  error("save ")
	 CHECKBOX ck_w1  300 @ 100 . , option(excel) label("Excel")
	 CHECKBOX ck_w2  400 @ 100 . , option(csv) label("csv")
	* TEXT tx_wd1_1 450 @ 40 ., label("sfolder")
	* EDIT ed_wd1_1 500 @ 100 .,  error("sfolder ")

	 
	 * CHECKBOX ck_wpanel  230 @ 120 . , option(wide) label("wide panel")
	 
	 * smart_klips_search_v3 
	 GROUPBOX gb_opts1 10 +40 600 45 , label("KLIPS 원자료 변수 검색") 
	 TEXT tx_wave1_5    20 +20 200 ., label("가구용 또는 개인용 (필수)")
	 RADIO rd_wave1_6    180 @ 110 .,  first label("가구용") option(h)
	 RADIO rd_wave1_7    240  @ 110 .,  last label("개인용") option(p)
	 
	 TEXT tx_wave1_9 340 @ 100 ., label("검색어")
	 EDIT ed_wave1_9 380 @ 150 .,  error("word")		 
		
	/*================================================================*/ 
	 TEXT tx_wave33  20 +40 450 ., label("차수선택 : 1차~23차 (필수) ('-'을 이용하여 입력가능(예: 12-23))") 
	 COMBOBOX vl_dta3 20 +20 520 240, dropdown contents(region_list3) append default("")	 
	 	 
	 TEXT tx_wd2 20 +30 450 ., label("KLIPS원자료 저장 경로")
	 *EDIT ed_wd2 160 @ 430 .,  error("wd")
	 FILE dbsamex  160 @ 400 ., label ("찾아보기...") directory tooltip("working directory 설정") nomemory  option("inisave") 
	 TEXT tx_wd3 20 +30 150 ., label("website (http:// 로 시작)")
	 EDIT ed_wd3 160 @ 320 .,  error("website")	
	 
END


LIST sel_list1
BEGIN
	program model_GJ_show
	program model_T20_show	
	program model_T20_show
	program model_T20_show	
	program model_T20_show
	program model_T20_show	
	program model_T20_show
	program model_T20_show	
	program model_T20_show
	program model_T20_show	
	program model_T20_show
	program model_T20_show	
	program model_T20_show
	program model_T20_show	
	program model_T20_show
END

LIST sel_list2
BEGIN
	program model_GJ_show
	program model_T60_show	
	program model_T60_show
	program model_T60_show	
	program model_T60_show
	program model_T60_show	
	program model_T60_show
	program model_T60_show	
	program model_T60_show
	program model_T60_show	
	program model_T60_show
	program model_T60_show	
	program model_T60_show
	program model_T60_show	
	program model_T60_show
END


PROGRAM	model_GJ_show
BEGIN
	call main.ed_wave5_1.show
	call main.ed_wave5_2.show
	
	call main.ed_wave6_1.hide
	call main.ed_wave6_2.hide
	call main.ed_wave7_1.hide
	call main.ed_wave7_2.hide	
	
END

PROGRAM	model_T20_show
BEGIN
	call main.ed_wave5_1.show
	call main.ed_wave5_2.show
	
	call main.ed_wave6_1.show
	call main.ed_wave6_2.show
	call main.ed_wave7_1.hide
	call main.ed_wave7_2.hide	
	
END

PROGRAM	model_T60_show
BEGIN
	call main.ed_wave5_1.show
	call main.ed_wave5_2.show
	
	call main.ed_wave6_1.show
	call main.ed_wave6_2.show
	call main.ed_wave7_1.show
	call main.ed_wave7_2.show	
	
END




/***** 노동패널팀 수정: h_wieght18 변수추가에 따른 목록 추가 ****/ 

LIST region_list1
BEGIN
	h_resid_type
	h_hprice
	h_region
	h_hsex
	h_hage
	h_kidage06
	h_kidage712
	h_kidage1315
	h_hmarital
	h_num
	h_hedu
	h_inc_1
	h_inc_2
	h_inc_3
	h_inc_4
	h_inc_5
	h_inc_6
	h_inc_total
	h_asset_1
	h_asset_2_1
	h_asset_2_2
	h_asset_3_1
	h_asset_3_2
	h_debt_total
	h_debt_pay
	h_kid
	h_incomeq
	h_eqscale_ori
	h_eqscale_mod
	h_weight98
	h_weight09
	h_weight18
	h_sample98
	h_sample09	
	h_sample18
END

/***** 노동패널팀 수정: p_wieght18_l, p_weight18_c 변수추가에 따른 목록 추가 ****/ 

LIST region_list2
BEGIN
	p_sex
	p_age
	p_rel
	p_edu
	p_religion
	p_married
	p_region
	p_econstat
	p_jobtype
	p_wage
	p_hours
	p_employ_type
	p_job_status
	p_ind2000
	p_ind2007
	p_ind2017
	p_jobfam2000
	p_jobfam2007
	p_jobfam2017
	p_firm_size
	p_job_begin
	p_weight98_l
	p_weight98_c
	p_weight09_l
	p_weight09_c
	p_weight18_l
	p_weight18_c
	p_sample98
	p_sample09
	p_sample18
END


LIST region_list3
BEGIN
	01
	02
	03
	04
	05
	06
	07
	08
	09
	10
	11
	12
	13
	14
	15
	16
	17
	18
	19
	20
	21
	22
	23
END

LIST stat_list1
BEGIN
    ""     
	청년(3차) 
	건강과은퇴(4차) 
	중고령자(6차) 
	근로시간과여가(7차)  
	노동조합과노사(8차)
	청년(9차)
	고용형태(10차)  
	교육(11차) 
	시간사용과삶의질(17차)  
	삶의인식/장년(18차)  	 
	청년(19차) 
	의사결정(20차)  
	고용형태 (21차) 
	비임금(22차)
	코로나19(23차)
END

LIST stat_value1
BEGIN  
    0 
	03
	04
	06
	07
	08	
	09
	10
	11
	17
	18
	19
	20
	21
	22
	23
END


SCRIPT button1 
BEGIN	
	main.vl_dta1.enable
	main.vl_dta2.enable
	main.ed_wd1.enable	
	main.vl_dta3.enable
    main.dbsamex.enable
	main.ed_wd3.enable
	main.ed_wave3.enable
	main.ed_wave4.enable
	main.ed_wave5_1.enable	
	main.ed_wave5_2.enable	
	main.ed_wave6_1.enable	
	main.ed_wave6_2.enable	
	main.ed_wave7_1.enable	
	main.ed_wave7_2.enable	
	main.ck_w1.enable 
	main.ck_w2.enable 
	main.rd_wave1_6.disable
	main.rd_wave1_7.disable
	main.ed_wave1_9.disable	
	
END

	 
SCRIPT button2 
BEGIN
	main.vl_dta1.disable
	main.vl_dta2.disable
	main.ed_wd1.disable	
	main.ed_wave3.disable	
	main.ed_wave4.disable	
	main.ed_wave5_1.disable
	main.ed_wave5_2.disable	
	main.ed_wave6_1.disable	
	main.ed_wave6_2.disable	
	main.ed_wave7_1.disable
	main.ed_wave7_2.disable
	main.ck_w1.disable 
	main.ck_w2.disable 	
	main.vl_dta3.enable
	main.dbsamex.enable
	main.ed_wd3.enable	
	main.rd_wave1_6.enable
	main.rd_wave1_7.enable
	main.ed_wave1_9.enable	
	
END


*OK ok1, label("확인")
*CANCEL can1, label("취소")
SUBMIT sub1, label("확인")
COPY copy1,
HELP hlp1, view("help smart_klips_v3")
RESET res1,
PROGRAM command
BEGIN 
if main.rd_wave00 {
	  
    put "smart_klips_v3  " 	
	   put main.vl_dta1 
	   put main.vl_dta2
	   put " , "
	   
	   * beginoptions 
	   put "wave("
	   put main.vl_dta3
	   put ") "
	   
	   if main.ed_wave3 {
		   put "add_h("
		   put main.ed_wave3
		   put ") "
	   }
	   if main.ed_wave4 {
		   put "add_p("
		   put main.ed_wave4
		   put ") "
	   }
	   
	    if main.ed_wave5_2 {
		   put "add_a1("
		   put main.ed_wave5_2
		   put ") "
		}
		if main.ed_wave6_2 {
		   put "add_a2("
		   put main.ed_wave6_2
		   put ") "
		}
		
		if main.ed_wave7_2 {
		   put "add_a3("
		   put main.ed_wave7_2
		   put ") "	  
		}
		
		if main.ed_wave5_2 {
		   put "a1_wave("
		   put main.ed_wave5_1 
		   put ") "
		}  
		 
		if main.ed_wave6_2 { 
		   put "a2_wave("
		   put main.ed_wave6_1 
		   put ") "
		}
		
		if main.ed_wave7_2 {
		   put "a3_wave("
		   put main.ed_wave7_1 
		   put ") "
		}
		
		if main.dbsamex {
		   put "wd( "
		   put main.dbsamex
		   put ")  "
		}
		
		if main.ed_wd3 {
		   put "website( "
		   put main.ed_wd3
		   put ") "
		}
		
		if main.ed_wd1 {
		   put "save( "
		   put main.ed_wd1
		   put ") "
		}
		
		/*
		if main.ed_wd1_1 {
		   put "sfolder( "
		   put main.ed_wd1_1
		   put ") "
		}
		*/
   
		   if main.ck_w1 {
			put "excel " 
		   }
		   if main.ck_w2 {
			put "csv " 
		   }  	   

}

if main.rd_wave01 {	  
       put "smart_klips_search_v3  " 	
	   put " , "
	   
	   * beginoptions 
	   put "wave("
	   put main.vl_dta3
	   put ") "
	   
	   if main.dbsamex {
			   put "wd( "
			   put main.dbsamex
			   put ")  "
		}
		
       if main.ed_wd3 {
			   put "website( "
			   put main.ed_wd3
			   put ") "
		}

	   if main.rd_wave1_6 {
	   put "hp(h) "
	   }	   
	   if main.rd_wave1_7 {
	   put "hp(p) "
	   } 
	   put "word("
	   put main.ed_wave1_9
	   put ") "
}
		   		   
END
